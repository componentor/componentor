import path from 'path'
import { fileURLToPath } from 'url'

const __filename = fileURLToPath(import.meta.url)
const __dirname = path.dirname(__filename)

export default async ({ req, res, next }) => {

    const { addMenuPage, addSubMenuPage } = req.hooks
    const { translate, parseVue } = req.context
    const locale = req?.user?.locale || 'en_US'

    const adminPages = [
        {
            capabilities: {
                manage_dashboard: 'manage_dashboard'
            },
            badge: 0,
            position: 1500,
            file: 'Builder.vue',
            slug: 'vueplay',
            page_title: translate('Vue Play', locale),
            menu_title: translate('Play', locale),
            icon: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 928 1000"><path d="m455.563.625 2.94-.148c9.154 1.37 15.513 6.808 21.685 13.336l1.998 2.04c3.858 3.973 7.54 8.075 11.164 12.26 2.444 2.794 4.986 5.492 7.525 8.2C506.174 42.015 511.13 47.926 516 54q1.527 1.86 3.059 3.715A501 501 0 0 1 540 85l1.416 1.97c17.58 24.486 33.99 49.68 48.139 76.311 1.42 2.672 2.854 5.336 4.289 8 10.528 19.67 19.242 39.85 27.04 60.745a618 618 0 0 0 3.018 7.86C638.83 278.459 647.33 320.749 650 362l.261 3.44c1.138 16.178.94 32.414.927 48.623l-.002 2.4c-.016 25.233-.325 50.363-2.186 75.537-.075 1.044-.15 2.088-.229 3.163-4.738 65.45-12.37 130.739-22.97 195.505l-.517 3.17c-.788 4.812-1.592 9.62-2.429 14.424l-.835 4.972-.41 2.238c-.929 5.638.1 7.703 3.273 12.192l2.242 2.961 1.215 1.606c3.1 4.078 6.279 8.088 9.496 12.074A1046 1046 0 0 1 645.5 754c3.084 3.934 6.178 7.857 9.313 11.75a1348 1348 0 0 1 25.652 33.047c1.841 2.394 3.806 4.622 5.851 6.844l1.697 1.915a92 92 0 0 0 3.318 3.542c2.548 2.918 3.65 4.97 3.73 8.913a344 344 0 0 1-2.979 24.097l-.582 3.716a4060 4060 0 0 1-1.574 9.94q-.662 4.164-1.32 8.33a12947 12947 0 0 1-3.116 19.63 9438 9438 0 0 0-3.202 20.232 9809 9809 0 0 1-2.76 17.433q-.827 5.193-1.643 10.387c-.604 3.848-1.22 7.694-1.838 11.54l-.54 3.47-.514 3.164-.437 2.752C674 957 674 957 672 960l-1.95-1.617a591 591 0 0 0-17.002-13.512c-4.019-3.074-8.01-6.18-11.986-9.308l-1.77-1.393L634 930q-3.375-2.658-6.75-5.312l-1.72-1.354a2515 2515 0 0 0-12.164-9.485A1851 1851 0 0 1 587 893l-1.61 1.242-2.14 1.633-2.11 1.617c-5.112 3.601-8.743 3.766-14.89 3.633l-2.402-.027c-1.95-.024-3.899-.06-5.848-.098l-.309 1.894c-1.373 8.003-3.306 15.819-5.351 23.672l-1.06 4.109q-1.103 4.268-2.212 8.534-1.42 5.471-2.831 10.945-1.09 4.225-2.185 8.45-.524 2.019-1.044 4.039-.726 2.806-1.457 5.613l-.837 3.224C540 974 540 974 539 976h-69v24h-24v-24h-56c-1.885-5.026-3.575-9.72-4.993-14.843l-.533-1.915q-.856-3.085-1.704-6.172l-1.198-4.323q-1.247-4.505-2.489-9.012a6303 6303 0 0 0-3.198-11.56q-1.234-4.452-2.463-8.905l-1.18-4.265a2858 2858 0 0 1-1.637-5.938l-.942-3.413C369 903 369 903 369 901l-1.709.063c-2.597.084-5.193.136-7.791.187l-2.687.102c-8.046.118-13.637-2.205-19.813-7.352-9.564 7.49-9.564 7.49-19.062 15.063-4.148 3.327-8.35 6.578-12.57 9.813-7.03 5.39-14.013 10.84-21.002 16.283a6833 6833 0 0 1-7.167 5.568l-2.37 1.84-4.607 3.573c-3.185 2.472-6.358 4.951-9.468 7.516l-2.692 2.219-2.214 1.867C254 959 254 959 251 959a69842 69842 0 0 1-13.726-86.591q-1.802-11.38-3.576-22.764-.507-3.247-1.02-6.495-.7-4.437-1.385-8.877l-.405-2.532c-1.962-12.873-1.962-12.873.913-17.874l2.512-2.992 2.78-3.395 1.462-1.74c1.859-2.238 3.64-4.532 5.423-6.832 4.442-5.726 9-11.357 13.584-16.97a690 690 0 0 0 13.981-17.731 880 880 0 0 1 7.894-10.144l1.377-1.75q2.82-3.583 5.646-7.164 1.467-1.86 2.933-3.722 1.362-1.73 2.728-3.458 1.24-1.574 2.455-3.17C296 733 296 733 297.597 731.265c2.333-2.69 4.238-4.9 4.674-8.508-.211-2.539-.626-4.955-1.134-7.451q-.501-2.954-.999-5.908l-.57-3.153c-.981-5.601-1.75-11.232-2.548-16.861l-1.078-7.41c-8.469-58.63-14.882-117.447-18.72-176.566q-.305-4.665-.62-9.33c-1.75-26.672-1.8-53.378-1.847-80.095a7206 7206 0 0 0-.022-8.227C274.535 332.747 284.716 258.278 315 189l1.376-3.196C330.906 152.173 348.126 120.151 369 90l1.226-1.778C381.86 71.426 394.312 55.172 408 40l1.496-1.667c5.118-5.691 10.346-11.24 15.809-16.603 1.9-1.888 1.9-1.888 4.195-4.792C436.226 9.034 444.833.988 455.563.625" fill="#CBCBCB"/><path d="M455 21h2v214l-20 3c-4.03 1.188-7.287 2.248-11 4l-3.09 1.426c-20.785 10.355-33.09 26.746-41.226 48.015-6.546 20.414-3.429 43.674 5.847 62.7 11.25 20.27 28.74 33.553 50.719 40.296 6.401 1.812 11.793 1.983 18.75 2.563v351h-10v133h-93c-2.25-7.878-2.25-7.878-2.942-11.079l-.478-2.199-.498-2.327-.539-2.496q-.87-4.042-1.73-8.087l-.606-2.834a2202 2202 0 0 1-11.705-58.65c-12.077-64.899-22.773-130.069-29.99-195.699q-.492-4.485-1.02-8.963c-1.502-12.884-2.534-25.799-3.555-38.729q-.39-4.922-.784-9.844-.243-3.033-.481-6.064c-.332-4.167-.691-8.322-1.181-12.474-1.2-10.486-1.522-21.081-2.053-31.617l-.103-2.036c-1.222-24.436-1.643-48.848-1.646-73.313q-.002-3.825-.012-7.65c-.042-26.867.515-53.727 4.26-80.377l.53-3.916c1.136-8.239 2.378-16.427 4.101-24.566.508-2.444.977-4.894 1.448-7.346 16.883-86.348 58.438-171.64 118.027-236.597a245 245 0 0 0 5.144-5.824C436.26 39.073 444.46 29.753 454 22z" fill="#FEFEFE"/><path d="m455.563.625 2.94-.148c9.154 1.37 15.513 6.808 21.685 13.336l1.998 2.04c3.858 3.973 7.54 8.075 11.164 12.26 2.444 2.794 4.986 5.492 7.525 8.2C506.174 42.015 511.13 47.926 516 54q1.527 1.86 3.059 3.715A501 501 0 0 1 540 85l1.416 1.97c17.58 24.486 33.99 49.68 48.139 76.311 1.42 2.672 2.854 5.336 4.289 8 10.528 19.67 19.242 39.85 27.04 60.745a618 618 0 0 0 3.018 7.86C638.83 278.459 647.33 320.749 650 362l.261 3.44c1.138 16.178.94 32.414.927 48.623l-.002 2.4c-.016 25.233-.325 50.363-2.186 75.537-.075 1.044-.15 2.088-.229 3.163-4.738 65.45-12.37 130.739-22.97 195.505l-.517 3.17c-.788 4.812-1.592 9.62-2.429 14.424l-.835 4.972-.41 2.238c-.929 5.638.1 7.703 3.273 12.192l2.242 2.961 1.215 1.606c3.1 4.078 6.279 8.088 9.496 12.074A1046 1046 0 0 1 645.5 754c3.084 3.934 6.178 7.857 9.313 11.75a1348 1348 0 0 1 25.652 33.047c1.841 2.394 3.806 4.622 5.851 6.844l1.697 1.915a92 92 0 0 0 3.318 3.542c2.548 2.918 3.65 4.97 3.73 8.913a344 344 0 0 1-2.979 24.097l-.582 3.716a4060 4060 0 0 1-1.574 9.94q-.662 4.164-1.32 8.33a12947 12947 0 0 1-3.116 19.63 9438 9438 0 0 0-3.202 20.232 9809 9809 0 0 1-2.76 17.433q-.827 5.193-1.643 10.387c-.604 3.848-1.22 7.694-1.838 11.54l-.54 3.47-.514 3.164-.437 2.752C674 957 674 957 672 960l-1.95-1.617a591 591 0 0 0-17.002-13.512c-4.019-3.074-8.01-6.18-11.986-9.308l-1.77-1.393L634 930q-3.375-2.658-6.75-5.312l-1.72-1.354a2515 2515 0 0 0-12.164-9.485A1851 1851 0 0 1 587 893l-1.61 1.242-2.14 1.633-2.11 1.617c-5.112 3.601-8.743 3.766-14.89 3.633l-2.402-.027c-1.95-.024-3.899-.06-5.848-.098l-.309 1.894c-1.373 8.003-3.306 15.819-5.351 23.672l-1.06 4.109q-1.103 4.268-2.212 8.534-1.42 5.471-2.831 10.945-1.09 4.225-2.185 8.45-.524 2.019-1.044 4.039-.726 2.806-1.457 5.613l-.837 3.224C540 974 540 974 539 976h-69v24h-24v-24h-56c-1.885-5.026-3.575-9.72-4.993-14.843l-.533-1.915q-.856-3.085-1.704-6.172l-1.198-4.323q-1.247-4.505-2.489-9.012a6303 6303 0 0 0-3.198-11.56q-1.234-4.452-2.463-8.905l-1.18-4.265a2858 2858 0 0 1-1.637-5.938l-.942-3.413C369 903 369 903 369 901l-1.709.063c-2.597.084-5.193.136-7.791.187l-2.687.102c-8.046.118-13.637-2.205-19.813-7.352-9.564 7.49-9.564 7.49-19.062 15.063-4.148 3.327-8.35 6.578-12.57 9.813-7.03 5.39-14.013 10.84-21.002 16.283a6833 6833 0 0 1-7.167 5.568l-2.37 1.84-4.607 3.573c-3.185 2.472-6.358 4.951-9.468 7.516l-2.692 2.219-2.214 1.867C254 959 254 959 251 959a69842 69842 0 0 1-13.726-86.591q-1.802-11.38-3.576-22.764-.507-3.247-1.02-6.495-.7-4.437-1.385-8.877l-.405-2.532c-1.962-12.873-1.962-12.873.913-17.874l2.512-2.992 2.78-3.395 1.462-1.74c1.859-2.238 3.64-4.532 5.423-6.832 4.442-5.726 9-11.357 13.584-16.97a690 690 0 0 0 13.981-17.731 880 880 0 0 1 7.894-10.144l1.377-1.75q2.82-3.583 5.646-7.164 1.467-1.86 2.933-3.722 1.362-1.73 2.728-3.458 1.24-1.574 2.455-3.17C296 733 296 733 297.597 731.265c2.333-2.69 4.238-4.9 4.674-8.508-.211-2.539-.626-4.955-1.134-7.451q-.501-2.954-.999-5.908l-.57-3.153c-.981-5.601-1.75-11.232-2.548-16.861l-1.078-7.41c-8.469-58.63-14.882-117.447-18.72-176.566q-.305-4.665-.62-9.33c-1.75-26.672-1.8-53.378-1.847-80.095a7206 7206 0 0 0-.022-8.227C274.535 332.747 284.716 258.278 315 189l1.376-3.196C330.906 152.173 348.126 120.151 369 90l1.226-1.778C381.86 71.426 394.312 55.172 408 40l1.496-1.667c5.118-5.691 10.346-11.24 15.809-16.603 1.9-1.888 1.9-1.888 4.195-4.792C436.226 9.034 444.833.988 455.563.625m-2.008 21.66-1.68 1.777a102 102 0 0 1-7.75 7.25c-3.885 3.357-7.252 7.037-10.64 10.887a387 387 0 0 1-6.935 7.579A306 306 0 0 0 410 69l-1.522 1.908c-24.532 30.797-44.714 64-62.478 99.092l-1.19 2.33C323.684 214.026 310.049 260.122 302 306l-.452 2.51c-1.834 10.26-3.07 20.566-4.173 30.928l-.374 3.46c-2.312 22.756-2.244 45.568-2.251 68.414l-.002 2.651c-.022 47.274 1.814 94.338 6.77 141.376.52 4.974.99 9.952 1.459 14.93 2.89 30.618 6.166 61.17 10.705 91.59q.467 3.153.928 6.307C321.906 717.924 330.047 767.702 340 817l.508 2.524a4901 4901 0 0 0 6.139 29.962q1.481 7.121 2.931 14.248l1.36 6.641.604 2.99.548 2.658.464 2.28c.299 1.718.299 1.718 1.446 2.697 2.891.095 5.759.126 8.65.114h2.794q4.5-.002 8.997-.016l5.537-.003c6.862-.006 13.723-.02 20.584-.033L447 881V749h23v132h99c3.165-13.924 6.319-27.839 9.25-41.812l.571-2.72c4.827-23.076 9.04-46.26 13.179-69.468l.481-2.69c9.18-51.342 9.18-51.342 17.154-102.88.729-5.103 1.477-10.2 2.286-15.29 2.581-16.258 4.705-32.545 6.641-48.89l.462-3.865c2.116-17.737 4.203-35.469 5.785-53.262q.327-3.613.663-7.225c3.623-39.227 5.7-78.182 5.773-117.576q.008-3.423.021-6.846c.077-24.292-.97-48.383-4.266-72.476l-.268-2.056C614.377 240.52 567.715 151.302 508 77l-2.297-2.852A978 978 0 0 0 499 66l-1.264-1.526c-6.517-7.85-13.284-15.417-20.25-22.87a430 430 0 0 1-4.408-4.842C465.601 28.283 465.601 28.283 457 21c-2.073-.221-2.073-.221-3.445 1.285" fill="#374759"/><path d="M447 749h23v153h88c-2.347 10.561-4.689 21.045-7.418 31.5l-.917 3.54q-.944 3.64-1.893 7.28-1.457 5.592-2.903 11.188l-1.85 7.117-.874 3.377-.81 3.1-.71 2.729C540 974 540 974 539 976h-69v24h-24v-24h-56c-1.887-5.032-3.576-9.729-4.993-14.86l-.533-1.919q-.856-3.092-1.704-6.186l-1.198-4.33q-1.247-4.512-2.489-9.025-1.595-5.795-3.198-11.588a13976 13976 0 0 1-3.643-13.193l-1.637-5.946-.942-3.419C369 903 369 903 369 902h78z" fill="#61AF83"/><path d="M496 257c13.36 9.199 22.114 20.803 27.313 36.063l.771 2.253c5.895 18.259 3.004 38.742-5.615 55.696-10.26 16.963-25.378 28.308-44.696 33.133-19.22 3.979-37.325.24-53.773-10.145-15.546-11.145-27.59-26.753-31.582-45.773-2.601-20.083 2.088-38.533 14.457-54.664C426.598 246.116 464.107 237.577 496 257" fill="#364659"/><path d="M620 723c6.833 6.406 12.3 14.074 18.023 21.457 5.547 7.136 11.122 14.252 16.79 21.293a1348 1348 0 0 1 25.652 33.047c1.841 2.394 3.806 4.622 5.851 6.844l1.697 1.915a92 92 0 0 0 3.318 3.542c2.548 2.918 3.65 4.97 3.73 8.913a344 344 0 0 1-2.979 24.097l-.582 3.716a4060 4060 0 0 1-1.574 9.94q-.662 4.164-1.32 8.33a12947 12947 0 0 1-3.116 19.63 9438 9438 0 0 0-3.202 20.232 9809 9809 0 0 1-2.76 17.433q-.827 5.193-1.643 10.387c-.604 3.848-1.22 7.694-1.838 11.54l-.54 3.47-.514 3.164-.437 2.752C674 957 674 957 672 960l-1.95-1.617a591 591 0 0 0-17.002-13.512c-4.019-3.074-8.01-6.18-11.986-9.308l-1.77-1.393L634 930q-3.375-2.658-6.75-5.312l-1.723-1.356a1692 1692 0 0 0-9.847-7.68A1350 1350 0 0 1 586 892l.728-2.998c2.966-12.341 5.51-24.753 7.998-37.198q.78-3.887 1.567-7.773l.477-2.408c1.117-5.51 1.117-5.51 2.23-6.623.272-1.328.49-2.666.684-4.008l.373-2.492.75-5.18.377-2.515.33-2.282C602 816 602 816 602.976 812.624c.981-3.475 1.643-6.849 2.207-10.413l.623-3.856.63-3.98c1.365-8.618 2.858-17.125 4.942-25.602.707-3.158 1.093-6.255 1.312-9.48.309-2.293.309-2.293 1.243-5.887 1.517-5.878 2.158-11.88 2.921-17.892.595-4.442 1.154-8.438 3.145-12.514M302 725h2l.304 2.13c2.729 19.03 5.498 38.05 9.981 56.76a272 272 0 0 1 4.29 23.087c2.332 16.432 6.194 32.558 9.899 48.723a4677 4677 0 0 1 1.547 6.785q1.194 5.25 2.403 10.495.66 2.87 1.317 5.742l.814 3.493.702 3.035c.727 2.69 1.653 5.188 2.743 7.75a609 609 0 0 1-18.96 15.135c-3.934 3.009-7.839 6.05-11.728 9.115-5.34 4.206-10.695 8.39-16.062 12.563l-2.278 1.77a20550 20550 0 0 1-11.769 9.14l-2.372 1.842-4.61 3.575c-3.184 2.472-6.357 4.951-9.467 7.516l-2.692 2.219-2.214 1.867C254 959 254 959 251 959a69842 69842 0 0 1-13.726-86.591q-1.802-11.38-3.576-22.764-.507-3.247-1.02-6.495-.7-4.437-1.385-8.877l-.405-2.532c-1.962-12.873-1.962-12.873.913-17.874l2.512-2.992 2.78-3.395 1.462-1.74c1.859-2.238 3.64-4.532 5.423-6.832 4.442-5.726 9-11.357 13.584-16.97a690 690 0 0 0 13.981-17.731 880 880 0 0 1 7.894-10.144l1.377-1.75q2.82-3.583 5.646-7.164 2.177-2.76 4.353-5.524l1.394-1.766c2.518-3.2 4.965-6.438 7.356-9.734z" fill="#60AF82"/><path d="M458 247c19.82 0 35.98 6.13 50.188 20.16 7.25 7.786 11.714 15.89 15.125 25.902l.771 2.254c5.895 18.259 3.004 38.742-5.615 55.696-10.377 17.156-25.68 28.38-45.157 33.363C469 385 469 385 458 385z" fill="#1A1A1A"/><path d="M470 902h88c-2.347 10.561-4.689 21.045-7.418 31.5l-.917 3.54q-.944 3.64-1.893 7.28-1.457 5.592-2.903 11.188l-1.85 7.117-.874 3.377-.81 3.1-.71 2.729C540 974 540 974 539 976h-69z" fill="#7E8287"/><path d="M369 902h78v74h-57c-1.887-5.032-3.576-9.729-4.993-14.86l-.533-1.919q-.856-3.092-1.704-6.186l-1.198-4.33q-1.247-4.512-2.489-9.025-1.595-5.795-3.198-11.588a13976 13976 0 0 1-3.643-13.193l-1.637-5.946-.942-3.419C369 903 369 903 369 902" fill="#7B8085"/><path d="M458 235c19.966-.73 37.594 5.372 53 18l2.133 1.64c14.29 11.546 24.716 31.165 26.867 49.36 1.816 23.119-2.13 45.044-17.43 63.191L521 369l-2.312 3.063c-12.257 13.397-32.068 24.194-50.532 25.132l-3.656-.07-3.719-.055L458 397v-11h-8v-1l3.734-.113c20.644-.755 39.932-5.85 54.594-21.348C518.545 351.732 525.345 336.745 526 321l.121-2.316c.53-19.405-6.16-38.13-19.371-52.434-13.581-12.598-30.112-18.234-48.312-18.875l-2.768-.117q-3.334-.14-6.67-.258v-1h9z" fill="#989898"/><path d="M620 723c6.142 5.976 6.142 5.976 8 9-.035 2.119-.035 2.119-.617 4.434l-.64 2.675L626 742l-1.445 6.16q-.837 3.452-1.68 6.903l-1.404 5.784-1.477 6.068q-1.462 6.008-2.916 12.019c-2.77 11.445-5.545 22.889-8.34 34.328l-2.3 9.426-.575 2.35a2490 2490 0 0 0-7.55 31.9c-2.79 12.113-5.92 24.104-9.313 36.062l-3-1 .728-2.998c2.966-12.341 5.51-24.753 7.998-37.198q.78-3.887 1.567-7.773l.477-2.408c1.117-5.51 1.117-5.51 2.23-6.623.272-1.328.49-2.666.684-4.008l.373-2.492.75-5.18.377-2.515.33-2.282C602 816 602 816 602.976 812.624c.981-3.475 1.643-6.849 2.207-10.413l.623-3.856.63-3.98c1.365-8.618 2.858-17.125 4.942-25.602.707-3.158 1.093-6.255 1.312-9.48.309-2.293.309-2.293 1.243-5.887 1.517-5.878 2.158-11.88 2.921-17.892.595-4.442 1.154-8.438 3.145-12.514" fill="#4A8765"/><path d="m304 725 .304 2.13c2.728 19.029 5.506 38.042 9.977 56.753C317.035 795.826 318.72 807.82 320 820c-2.32-2.32-2.583-3.591-3.367-6.734l-.746-2.934-.762-3.082a668 668 0 0 0-6.094-22.653c-2.08-7.257-4.046-14.546-6.031-21.83-1.935-7.054-3.99-14.043-6.26-20.997-1.118-4.183-.982-6.607.26-10.77 3.716-6 3.716-6 7-6" fill="#4B8966"/></svg>'
        },
    ]

    const adminSubPages = [
        {
            capabilities: {
                manage_dashboard: 'manage_dashboard'
            },
            badge: 0,
            position: 1000,
            file: 'Builder.vue',
            parent_slug: 'vueplay',
            slug: '',
            page_title: translate('Drag & drop', locale),
            menu_title: translate('Drag & drop', locale)
        },
    ]

    for (const { badge, capabilities, position, file, slug, page_title, menu_title, icon } of adminPages) {
        await addMenuPage({
            badge, capabilities, slug, page_title, menu_title, position, icon, callback: async () => {
                const filePath = path.resolve(__dirname, `./ui/${file}`)
                return parseVue(filePath)
            }
        })
    }
    for (const { badge, capabilities, position, file, parent_slug, slug, page_title, menu_title } of adminSubPages) {
        await addSubMenuPage({
            badge, capabilities, parent_slug, slug, page_title, menu_title, position, callback: async () => {
                const filePath = path.resolve(__dirname, `./ui/${file}`)
                return parseVue(filePath)
            }
        })
    }
}